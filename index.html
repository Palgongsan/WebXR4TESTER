<!DOCTYPE html>
<!--
  [상세 참고 주석]
  - 아래 HTML 구조는 root/ref/ar-barebones.html에서 안내하는 WebXR 세션 생성 흐름과 DOM Overlay 구성을 기반으로 재작성하였다.
  - 실제 세션 생성은 <model-viewer>의 enterAR() 유틸리티를 사용하지만, 상단 주석으로 베어본 예제의 흐름을 유지하여 추후 필요 시 직접 WebXR API로 전환할 수 있게 한다.
  - DOM Overlay는 slot="ar-dom-overlay" 사용 지침을 준수하며, 추가 UI/무드 역시 root/ref/full index.txt의 <div id="webXR" class="demo"> 레이아웃을 최대한 참고하였다.
-->
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="description" content="세라젬 V11 제품 카탈로그 AR 프로토타입" />
    <title>세라젬 V11 AR 카탈로그 프로토타입</title>
    <!--
      root/ref/common.css의 타이포그래피 및 오버레이 컨벤션을 styles.css에서 @import로 재사용한다.
      (세부 스타일과 병합 내역은 styles.css 상단 주석 참고)
    -->
    <link rel="stylesheet" href="styles.css" />
    <!-- 최신 <model-viewer> CDN. module/nomodule 동시 로딩으로 브라우저 호환성을 확보한다. -->
    <script
      type="module"
      src="https://cdn.jsdelivr.net/npm/@google/model-viewer@3.3.0/dist/model-viewer.min.js"
    ></script>
    <script
      nomodule
      src="https://cdn.jsdelivr.net/npm/@google/model-viewer@3.3.0/dist/model-viewer-legacy.min.js"
    ></script>
  </head>
  <body>
    <!--
      [AR 세션 옵션 개요 – ar-barebones.html 참고 요약]
      1. navigator.xr.isSessionSupported('immersive-ar') 확인으로 지원 여부를 판별한다.
      2. requestSession 시 optionalFeatures로 'dom-overlay'를 요청하고, domOverlay.root에 실제 DOM 요소를 지정한다.
      3. 세션 시작 후 XRWebGLLayer를 구성하고, end 이벤트를 수신하여 UI를 원상복구한다.
      4. 본 구현에서는 <model-viewer>의 enterAR()가 위 과정을 내부 처리하며, DOM Overlay 루트만 slot 속성으로 지정한다.
    -->
    <div id="app" class="app-shell">
      <header class="app-header">
        <img src="img/header_img.png" alt="세라젬 헤더 이미지" class="header-logo" />
      </header>

      <main class="viewer-stage">
        <!--
          model-viewer 설정 요약:
          - ar-modes="webxr"로 제한하여 Scene Viewer / Quick Look 폴백을 차단한다.
          - camera-controls로 Web 환경에서의 조작성을 제공하며, AR 전환 시에도 DOM Overlay가 유지되도록 한다.
          - model-rotation은 초기 정면 뷰를 고정하기 위해 명시하며, Rotate 기능에서 JS로 값을 갱신한다.
        -->
        <model-viewer
          id="catalog-viewer"
          src="src/CERA_V11_low_Draco6_WebP_4K_001_self_optimize.glb"
          alt="세라젬 V11 안마 의자 AR 미리보기"
          ar
          ar-modes="webxr"
          ar-scale="fixed"
          camera-controls
          touch-action="pan-y"
          shadow-intensity="0.8"
          interaction-prompt="none"
          environment-image="neutral"
          ar-status="not-presenting"
          camera-orbit="0deg 80deg 5m"
          camera-target="0m 1m 0m"
          orientation="0deg 0deg -25deg"
        >
          <!--
            Hotspot: 사용자가 3D 공간에서 직접 애니메이션 전환 버튼을 누를 수 있도록 구성.
            data-position / data-normal은 실제 배치를 추후 수정하기 쉽도록 주석으로 안내한다.
            TODO: 실제 카달로그 촬영 환경에서 측정한 좌표로 data-position 값을 튜닝할 것.
          -->
          <button
            id="animation-toggle-button"
            class="overlay-control screen-hotspot"
            slot="hotspot-animation"
            aria-label="애니메이션 전환"
            data-visibility-attribute="visible"
            data-position="0m 1.5m 0m"
            data-normal="0 0 1"
          >
            <img
              id="animation-thumb"
              src="img/V11_thumbnail.webp"
              alt="현재 애니메이션 썸네일"
            />
          </button>

          <button
            id="color-cycle-button"
            class="overlay-control screen-hotspot"
            slot="hotspot-color"
            aria-label="컬러 텍스처 순환"
            data-visibility-attribute="visible"
            data-position="0m 1.5m 0m"
            data-normal="0 0 1"
          >
            <img
              src="img/V11_colorchange_thumbnail.webp"
              alt="컬러 변경 썸네일"
            />
          </button>

          <button
            id="rotate-button"
            class="overlay-control screen-hotspot"
            slot="hotspot-rotate"
            aria-label="모델 회전"
            data-visibility-attribute="visible"
            data-position="0m 1.5m 0m"
            data-normal="0 0 1"
          >
            <img
              src="img/V11_rotate_thumbnail.webp"
              alt="회전 썸네일"
            />
          </button>

          <!--
            slot="ar-button" 커스텀 AR 진입 버튼
            - modelviewer.dev 예제를 참고해 이미지 기반 버튼으로 구성
            - 위치/크기는 styles.css의 .ar-entry-button CSS 커스텀 프로퍼티로 손쉽게 조정 가능
          -->
          <button
            id="custom-ar-button"
            class="ar-entry-button"
            slot="ar-button"
            type="button"
            aria-label="AR 세션 시작"
          >
            <img src="img/AR in.png" alt="AR 세션 진입" />
          </button>

        </model-viewer>
      </main>
    </div>

    <!--
      app.js는 DOMContentLoaded 이전에 실행되어야 할 로직이 없어 module 스크립트로 defer 없이 바로 로드한다.
      (module 스크립트는 기본적으로 defer 동작을 하므로 렌더 블로킹 없이 초기화된다.)
    -->
    <script type="module" src="app.js"></script>
  </body>
</html>
